/*! player-api main - built with Grunt - DO NOT MODIFY THIS FILE DIRECTLY - built 04-19-2015 */
"use strict";var App=angular.module("App",["ngSanitize","ngResource","spotify"]);App.value("spotifyConfig",{spotifyHelperUrl:"https://pnmxtktyhx.spotilocal.com:4371/remote/"}),App.service("getTokens",["$http","$q",function(a,b){var c=b.defer();return a.jsonp("/api/auth/gettokens",{params:{callback:"JSON_CALLBACK"}}).success(function(a,b,d,e){a&&a.success?c.resolve(a.tokens):c.reject(a.error)}).error(function(a,b,d,e){c.reject("Unable to fetch Spotify tokens.")}),c.promise}]),App.service("spotifyHelper",["$http","$q","getTokens","$rootScope","templates",function(a,b,c,d,e){function f(a){var b=_.template(e.spotifyCommandUrl);return encodeURI(b(a))}function g(c){var d=b.defer();return a.get(c,{params:{callback:"JSON_CALLBACK"}}).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject("Unable to send Spotify command.")}),d.promise}var h={};return c.then(function(a){h=a,d.$broadcast("spotifyHelperLoaded")})["catch"](function(a){console.error(a),d.$broadcast("spotifyHelperError")}),{play:function(a){if(h.csrf&&h.access&&a){var b=f({action:"play",csrf:h.csrf,oauth:h.access,suffix:"uri="+a+"&context="+a});return g(b)}console.error("Spotify Helper must be loaded before issuing commands.")},pause:function(){if(h.csrf&&h.access){var a=f({action:"pause",csrf:h.csrf,oauth:h.access,suffix:"pause=true"});return g(a)}console.error("Spotify Helper must be loaded before issuing commands.")},status:function(){if(h.csrf&&h.access){var a=f({action:"status",csrf:h.csrf,oauth:h.access,suffix:"returnon=login,logout,play,pause,error,ap&returnafter=60"});return g(a)}console.error("Spotify Helper must be loaded before issuing commands.")}}}]),App.service("templates",["spotifyConfig",function(a){return{spotifyCommandUrl:a.spotifyHelperUrl+"<%= action %>.json?csrf=<%= csrf %>&oauth=<%= oauth %>&<%= suffix %>&ref=&cors"}}]),App.controller("Main",["$scope","$element","spotifyHelper","$timeout",function(a,b,c,d){a.$on("spotifyHelperLoaded",function(){console.log("Starting playback..."),c.play("spotify:track:6qIhYlaLt0ra6YohxThTqi"),d(function(){console.log("Pulling playback status..."),c.status().then(function(a){console.log(a)})},2500),d(function(){console.log("Pausing playback..."),c.pause()},5e3)})}]),App.directive("directive",["$",function(a){return{restrict:"A",link:function(a,b,c){}}}]);